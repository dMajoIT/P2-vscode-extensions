' code examples that are not highlighting correctly
'
PUB oscilloscope() | chanA, chanB
'' TASK: display oscilloscope waveforms

    debug(`scope Scope1 pos 100 0 size 800 600 linesize 6)  ' end of line comments
    debug(`Scope1 'Analog Input' 0 3300 250 0 %1111 red)
    debug(`Scope1 'Digital Output' 0 3300 250 300 %1111 green) ' end of line comments
    debug(`Scope1 samples 16 trigger -1)
    debug(`term Term1 pos 914 71 size 30 1 textsize 20 color red) ' end of line comments
    debug(`term Term2 pos 914 0 size 30 1 textsize 20 color green)

    repeat
        'chanA := analog[CHAN_A_IDX].read()
        'chanB := analog[CHAN_B_IDX].read()

        debug(`Term1 0) ' end of line comments
        debug(`Term2 0)
        debug(`Term1 'Pin 0 = ' '`(chanA)' ' *0.001V')
        debug(`Term2 'Pin 1 = ' '`(chanB)' ' *0.001V') ' end of line comments
        debug(`Scope1 `(chanA) `(chanB))
        waitms(20)


' EXMAPLEs from Spin2 doc (chips examples)

' -----------------
'  SCOPE (1)  - Oscilloscope with 1..8 channels, can trigger on level with hysteresis

CON _clkfreq = 10_000_000
PUB go() | i
  debug(`SCOPE MyScope2 SIZE 254 84 SAMPLES 128)
  debug(`MyScope2 'Sawtooth' 0 63 64 10 %1111)
  repeat
    debug(`MyScope2 `(i & 63))
    i++
    waitms(50)

' -----------------
'  SCOPE (2)

CON _clkfreq = 100_000_000

PUB go() | a, af, b, bf
  debug(`SCOPE MyScope)
  debug(`MyScope 'FreqA' -1000 1000 100 136 15 MAGENTA)
  debug(`MyScope 'FreqB' -1000 1000 100 20 15 ORANGE)
  debug(`MyScope TRIGGER 0 HOLDOFF 2)
  repeat
    a := qsin(1000, af++, 200)
    b := qsin(1000, bf++, 99)
    debug(`MyScope `(a,b))
    waitus(200)

' -----------------
' TERM (1)
CON _clkfreq = 10_000_000

PUB go() | i
  debug(`TERM MyTerm SIZE 9 1 TEXTSIZE 40)
  repeat
    repeat i from 50 to 60
      debug(`MyTerm 1 'Temp = `(i)')
      waitms(500)

' -----------------
' LOGIC (1)

CON _clkfreq = 10_000_000
PUB go() | i
  debug(`LOGIC MyLogic SAMPLES 32 'Low' 3 'Mid' 2 'High')
  debug(`MyLogic TRIGGER $07 $04 HOLDOFF 2)
  repeat
    debug(`MyLogic `(i & 63))
    i++
    waitms(25)

' -----------------
' LOGIC (2)

CON _clkfreq  = 333_333_333  'go really fast, 3ns clock period
    rxpin = 24
    txpin = rxpin + 1
    samps = 32
    bufflongs = samps / 16
    xmode = $D0800000 + rxpin << 17 + samps   'streamer mode

VAR buff[bufflongs]

PUB go() | i, buffaddr

  debug(`logic Serial samples `(samps) spacing 12 'TX' 'IN' longs_2bit)
  debug(`Serial trigger %10 %10 22)
  buffaddr := @buff

repeat
    org
        wrpin   ##+1<<28, #rxpin        ' rxpin inputs txpin at rxpin+1

        wrpin   #%01_11110_0, #txpin    ' set async tx mode for txpin
        wxpin   ##1<<16+8-1, #txpin     ' set baud=sysclock/1 and size=8
        dirh    #txpin                  ' enable smart pin

        wrfast  #0, buffaddr            ' set write-fast at buff
        xinit   ##xmode, #0             ' start capturing 2-bit samples

        wypin   i, #txpin               ' transmit serial byte
        waitxfi                         ' wait for streamer capture done
    end

    debug(`Serial `uhex_long_array_(@buff, bufflongs))
    i++
    waitms(20)
